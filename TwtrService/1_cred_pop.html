<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css">
    <?!= include('style'); ?>
</head>
<body>
    <div style="margin-bottom:10px;">
        <form id="myForm" action="https://script.google.com/macros/s/AKfycbwMrxf5jzoka4rfaTKoVcveI3GazElEDwjuGGLm-ezi1PcMXEc/exec">
            <div class="info">
                <p>To collect data from Twitter you need to register a new application. Registering your application and connecting should be a one time only task.
                </p>
                <p><strong>Steps</strong>:</p>
                <ol>
                    <li>Register for an API key with Twitter at <a href="https://dev.twitter.com/apps/new" target="_blank">https://dev.twitter.com/apps/new</a> (if you've already registered for a TAGS sheet you can reuse your existing API Key and Secret).</li>
                    <ul>
                        <li>Name, description and website can be anything you like</li>
                        <li><strong>Important</strong> Include the Callback URLs 
                        <ul><li><code>https://script.google.com/macros/d/1zJWE5BhTED5VD6UAPj6CwZPnspf1S4MYtIi4NZiyQOKUOmSPAemaQaXX/usercallback</code></li>
                        <li><code>https://script.google.com/macros/s/AKfycbwMrxf5jzoka4rfaTKoVcveI3GazElEDwjuGGLm-ezi1PcMXEc/exec</code></li></ul>
                        </li>
                    </ul>
                    <li>Read the 'Developer Rules of the Road' before clicking 'Create your Twitter application'</li>
                    <li>Enter your Twitter application API key and secret in the form below:</li>
                </ol>
            </div>
            <div class="group">
                <label>API Key
			<input name="consumerKey" id="consumerKey" type="text" value="<?=getUserKey()?>" /></label>
                <span class="highlight"></span>
                <span class="bar"></span>
            </div>
            <div class="group">
                <label>API Secret
			<input name="consumerSecret" id="consumerSecret" type="text" value="<?=getUserSecret()?>" /></label>
                <span class="highlight"></span>
                <span class="bar"></span>
            </div>
            <input id="next_but" type="button" value="Next" class="action" onclick="google.script.run.processForm(this.parentNode);this.disabled = true;"/>
        </form>
    </div>
</body>
</html>